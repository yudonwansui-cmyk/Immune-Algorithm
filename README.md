# 基于人工免疫系统的智能算法实现与分析

本项目是“人工智能原理和应用”课程的期末大作业，旨在通过Python编程实践，深入探索并实现人工免疫算法（AIS）的两个核心分支：用于**异常检测**的**负选择算法**和用于**函数优化**的**克隆选择算法**。

---

## 📂 项目结构

本项目包含两个主要部分，分别存放在不同的子目录中：

1.  **`ImmuneAnomalyDetectionV1-V3`**: **负选择算法**的实现与实验。
    *   该部分实现了基于T细胞“负选择”机理的异常检测模型。
    *   通过在多个不同特性的数据集上进行实验，系统性地评估了该算法的性能与适用边界。
    *   包含自动化超参数调优脚本 `tuner.py` 和最终实验脚本 `main.py`。

2.  **`ImmuneAnomalyDetectionV4`**: **克隆选择算法**的实现与实验。
    *   该部分实现了基于B细胞“亲和力成熟”模型的全局优化算法。
    *   通过在多个国际标准测试函数上进行求解，全面检验了算法的收敛能力与精度。
    *   包含针对不同函数的专属调优脚本 `tuner_xxx.py` 和用于单次/批量实验的 `main_clonal_xxx.py`。

3.  **`cartoon`**: 算法原理的**交互式动画演示**。
    *   `negative_selection_demo.html`: 负选择算法“皇宫卫兵训练”过程的可视化。
    *   `clonal_selection_demo.html`: 克隆选择算法“超级抗体进化”过程的可视化。

---

## 🚀 主要成果与发现

### 1. 负选择算法 (用于异常检测)

该算法通过学习“自我”（正常样本）的分布来构建一个能够识别“非我”（异常样本）的检测器系统。

-   **基准测试**: 在经典的**威斯consin乳腺癌数据集**上，经过系统性的超参数调优，模型取得了**高达 0.9677 的 F1-Score**，证明了其在类别边界清晰、中低维度问题上的有效性。
-   **边界模糊性挑战**: 在**葡萄酒质量数据集**上，由于“优质酒”与“普通酒”在特征空间中边界模糊，算法未能找到有效的分类边界，揭示了该算法强依赖于“几何可分性”的前提。
-   **大规模高维挑战**: 在**信用卡欺诈检测数据集**上，受“维度灾难”和高计算复杂度的影响，模型性能不佳 (AUPRC ≈ 0.0087)，暴露了其在处理现代大规模、高维数据时的内在局限性。

### 2. 克隆选择算法 (用于函数优化)

该算法模仿抗体进化的过程，通过克隆和亲和度反比的超变异机制来寻找复杂函数的全局最优解。

-   **自动化调优**: 本项目为每个测试函数设计了专属的自动化调优脚本，以“量身定制”最优的种群大小和变异率。
-   **优异的优化性能**: 在为每个函数配置了最优参数后，算法表现出色：
    -   在**Rastrigin**和**Ackley**等多峰函数上，成功跳出局部最优陷阱，精准收敛至全局最优解。
    -   在病态的**Rosenbrock**（香蕉）函数上，展现了卓越的局部搜索精度，最终误差低至 `1e-5` 级别。
-   **算法特性分析**: 对比实验揭示了算法对不同函数拓扑的敏感性，例如，在平滑的Sphere函数上，一个过小的变异率反而会降低收敛速度。

---

## 🎮 动画演示

为了更直观地理解算法原理，本项目制作了两个交互式HTML动画。请下载 `cartoon` 目录下的文件，并用浏览器打开：

-   **`negative_selection_demo.html`**: 演示负选择算法如何通过淘汰与“自我”（蓝色圆点）过近的候选者，来生成能够覆盖“非我”空间的“卫兵”（绿色方块）。
-   **`clonal_selection_demo.html`**: 演示克隆选择算法的种群（黄色圆点）如何在一代代的进化中，逐渐向Rastrigin函数的全局最小值（红色星星）聚集。

---

## 🛠️ 如何运行

### 依赖环境

-   Python 3.x
-   NumPy
-   Pandas
-   Scikit-learn
-   Matplotlib
-   Tqdm
-   Seaborn

可以使用以下命令安装所有依赖：
```bash
pip install numpy pandas scikit-learn matplotlib tqdm seaborn
```

### 运行异常检测实验 (负选择算法)

1.  进入 `ImmuneAnomalyDetectionV3` (或V1/V2) 目录。
2.  在 `config.py` 中配置你想要使用的数据集和参数。
3.  运行 `python main.py` 执行一次实验。
4.  运行 `python tuner_wine.py` (或其他tuner) 进行参数调优。

### 运行函数优化实验 (克隆选择算法)

1.  进入 `ImmuneAnomalyDetectionV4` 目录。
2.  在 `config_clonal.py` 中配置你想优化的目标函数和全局超参数。
3.  运行 `python main_clonal_one.py` 执行一次针对性的实验。
4.  运行 `python main_clonal.py` 执行预设的批量实验。
5.  运行 `tuner_sphere.py` (或其他tuner) 为特定函数寻找最优参数。

---
yudon
## 👨‍💻 作者

-   **yudon**
-   **课程**: 人工智能原理和应用
-   **指导老师**: Sir Wu

